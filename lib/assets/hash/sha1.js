(function(){"use strict";var t={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};return"undefined"!=typeof module&&module.exports&&(module.exports=t),t.bitArray={bitSlice:function(r,i,e){return r=t.bitArray._shiftRight(r.slice(i/32),32-(31&i)).slice(1),void 0===e?r:t.bitArray.clamp(r,e-i)},extract:function(t,r,i){var e,n=Math.floor(-r-i&31);return e=-32&(r+i-1^r)?t[r/32|0]<<32-n^t[r/32+1|0]>>>n:t[r/32|0]>>>n,e&(1<<i)-1},concat:function(r,i){if(0===r.length||0===i.length){return r.concat(i)}var s=r[r.length-1],h=t.bitArray.getPartial(s);return 32===h?r.concat(i):t.bitArray._shiftRight(i,h,0|s,r.slice(0,r.length-1))},bitLength:function(r){var e,i=r.length;return 0===i?0:(e=r[i-1],32*(i-1)+t.bitArray.getPartial(e))},clamp:function(r,i){if(32*r.length<i){return r}r=r.slice(0,Math.ceil(i/32));var e=r.length;return i=31&i,e>0&&i&&(r[e-1]=t.bitArray.partial(i,r[e-1]&2147483648>>i-1,1)),r},partial:function(t,r,i){return 32===t?r:(i?0|r:r<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(r,i){if(t.bitArray.bitLength(r)!==t.bitArray.bitLength(i)){return!1}var n,e=0;for(n=0;n<r.length;n++){e|=r[n]^i[n]}return 0===e},_shiftRight:function(r,i,e,n){var s,o,h=0;for(void 0===n&&(n=[]);i>=32;i-=32){n.push(e),e=0}if(0===i){return n.concat(r)}for(s=0;s<r.length;s++){n.push(e|r[s]>>>i),e=r[s]<<32-i}return h=r.length?r[r.length-1]:0,o=t.bitArray.getPartial(h),n.push(t.bitArray.partial(i+o&31,i+o>32?e:n.pop(),1)),n},_xor4:function(t,r){return[t[0]^r[0],t[1]^r[1],t[2]^r[2],t[3]^r[3]]}},t.codec.bytes={fromBits:function(r){var n,s,i=[],e=t.bitArray.bitLength(r);for(n=0;e/8>n;n++){0===(3&n)&&(s=r[n/4]),i.push(s>>>24),s<<=8}return i},toBits:function(r){var e,i=[],n=0;for(e=0;e<r.length;e++){n=n<<8|r[e],3===(3&e)&&(i.push(n),n=0)}return 3&e&&i.push(t.bitArray.partial(8*(3&e),n)),i}},t.codec.utf8String={fromBits:function(r){var n,s,i="",e=t.bitArray.bitLength(r);for(n=0;e/8>n;n++){0===(3&n)&&(s=r[n/4]),i+=String.fromCharCode(s>>>24),s<<=8}return decodeURIComponent(escape(i))},toBits:function(r){r=unescape(encodeURIComponent(r));var e,i=[],n=0;for(e=0;e<r.length;e++){n=n<<8|r.charCodeAt(e),3===(3&e)&&(i.push(n),n=0)}return 3&e&&i.push(t.bitArray.partial(8*(3&e),n)),i}},t.codec.hex={fromBits:function(r){var e,i="";for(e=0;e<r.length;e++){i+=((0|r[e])+0xf00000000000).toString(16).substr(4)}return i.substr(0,t.bitArray.bitLength(r)/4)},toBits:function(r){var i,n,e=[];for(r=r.replace(/\s|0x/g,""),n=r.length,r+="00000000",i=0;i<r.length;i+=8){e.push(0^parseInt(r.substr(i,8),16))}return t.bitArray.clamp(e,4*n)}},t.hash.sha1=function(t){t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},t.hash.sha1.hash=function(r){return(new t.hash.sha1).update(r).finalize()},t.hash.sha1.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(r){"string"==typeof r&&(r=t.codec.utf8String.toBits(r));var i,e=this._buffer=t.bitArray.concat(this._buffer,r),n=this._length,s=this._length=n+t.bitArray.bitLength(r);for(i=this.blockSize+n&-this.blockSize;s>=i;i+=this.blockSize){this._block(e.splice(0,16))}return this},finalize:function(){var r,i=this._buffer,e=this._h;for(i=t.bitArray.concat(i,[t.bitArray.partial(1,1)]),r=i.length+2;15&r;r++){i.push(0)}for(i.push(Math.floor(this._length/4294967296)),i.push(0|this._length);i.length;){this._block(i.splice(0,16))}return this.reset(),e},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(t,r,i,e){return 19>=t?r&i|~r&e:39>=t?r^i^e:59>=t?r&i|r&e|i&e:79>=t?r^i^e:void 0},_S:function(t,r){return r<<t|r>>>32-t},_block:function(t){{var r,i,e,n,s,h,o,f=t.slice(0),a=this._h;this._key}for(e=a[0],n=a[1],s=a[2],h=a[3],o=a[4],r=0;79>=r;r++){r>=16&&(f[r]=this._S(1,f[r-3]^f[r-8]^f[r-14]^f[r-16])),i=this._S(5,e)+this._f(r,n,s,h)+o+f[r]+this._key[Math.floor(r/20)]|0,o=h,h=s,s=this._S(30,n),n=e,e=i}a[0]=a[0]+e|0,a[1]=a[1]+n|0,a[2]=a[2]+s|0,a[3]=a[3]+h|0,a[4]=a[4]+o|0}},function(r){var i;if(r instanceof String||"string"==typeof r){i=t.codec.utf8String.toBits(r)}else{if(r instanceof ArrayBuffer){var e=new Uint8Array(r);i=t.codec.bytes.toBits(e)}else{if(!(r instanceof Buffer)){throw Error("invalid input type")}i=t.codec.bytes.toBits(r)}}return t.codec.hex.fromBits(t.hash.sha1.hash(i))}})();